{"title":"Scrapy的运作流程","slug":"Scrapy-01","date":"2018-12-02T07:21:06.000Z","updated":"2018-12-02T07:32:26.802Z","comments":true,"path":"api/articles/Scrapy-01.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<h2 id=\"前言：\"><a href=\"#前言：\" class=\"headerlink\" title=\"前言：\"></a>前言：</h2><p>​    看到个很通俗的Scrapy运行过程的解释，分享之。</p>\n<p>​    emmm……Scrapy的基本结构和入门教程以及本文章原文请参考<a href=\"http://www.runoob.com/w3cnote/scrapy-detail.html\" target=\"_blank\" rel=\"noopener\">这里</a></p>\n<h2 id=\"Scrapy的运作流程\"><a href=\"#Scrapy的运作流程\" class=\"headerlink\" title=\"Scrapy的运作流程\"></a>Scrapy的运作流程</h2><p>代码写好，程序开始运行…</p>\n<p><strong>1 引擎：Hi！Spider, 你要处理哪一个网站？</strong><br><strong>2 Spider：老大要我处理xxxx.com。</strong><br><strong>3 引擎：你把第一个需要处理的URL给我吧。</strong><br><strong>4 Spider：给你，第一个URL是xxxxxxx.com。</strong><br><strong>5 引擎：Hi！调度器，我这有request请求你帮我排序入队一下。</strong><br><strong>6 调度器：好的，正在处理你等一下。</strong><br><strong>7 引擎：Hi！调度器，把你处理好的request请求给我。</strong><br><strong>8 调度器：给你，这是我处理好的request</strong><br><strong>9 引擎：Hi！下载器，你按照老大的下载中间件的设置帮我下载一下这个request请求</strong><br><strong>10 下载器：好的！给你，这是下载好的东西。（如果失败：sorry，这个request下载失败了。然后引擎告诉调度器，这个request下载失败了，你记录一下，我们待会儿再下载）</strong><br><strong>11 引擎：Hi！Spider，这是下载好的东西，并且已经按照老大的下载中间件处理过了，你自己处理一下（注意！这儿responses默认是交给def parse()这个函数处理的）</strong><br><strong>12 Spider：（处理完毕数据之后对于需要跟进的URL），Hi！引擎，我这里有两个结果，这个是我需要跟进的URL，还有这个是我获取到的Item数据。</strong><br><strong>13 引擎：Hi ！管道 我这儿有个item你帮我处理一下！调度器！这是需要跟进URL你帮我处理下。然后从第四步开始循环，直到获取完老大需要全部信息。</strong><br><strong>14 管道调度器：好的，现在就做！</strong><br><strong>注意！只有当调度器中不存在任何request了，整个程序才会停止，（也就是说，对于下载失败的URL，Scrapy也会重新下载。）</strong></p>\n<h2 id=\"Scrapy爬虫制作过程\"><a href=\"#Scrapy爬虫制作过程\" class=\"headerlink\" title=\"Scrapy爬虫制作过程\"></a>Scrapy爬虫制作过程</h2><p>制作 Scrapy 爬虫 一共需要4步：<br>①新建项目 (scrapy startproject xxx)：新建一个新的爬虫项目<br>②明确目标 （编写items.py）：明确你想要抓取的目标<br>③制作爬虫 （spiders/xxspider.py）：制作爬虫开始爬取网页<br>④存储内容 （pipelines.py）：设计管道存储爬取内容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","categories":[{"name":"study","slug":"study","count":3,"path":"api/categories/study.json"}],"tags":[{"name":"python","slug":"python","count":2,"path":"api/tags/python.json"},{"name":"爬虫","slug":"爬虫","count":2,"path":"api/tags/爬虫.json"}]}